# üîê –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Å—Å–∏–µ–π NextAuth

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ Header, –Ω–æ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –Ω–µ–≥–æ (–ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ `/profile`) –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞.

## –ü—Ä–∏—á–∏–Ω–∞
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `window.location.href` –≤—ã–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
2. –°–µ—Å—Å–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (React context) –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞
3. `useSession()` –≤ Header –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏

## –†–µ—à–µ–Ω–∏–µ

### 1. –ò–∑–º–µ–Ω—ë–Ω —Å–ø–æ—Å–æ–± —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –≤ signin/page.tsx
**–ë—ã–ª–æ:**
```typescript
window.location.href = redirectPath;
```

**–°—Ç–∞–ª–æ:**
```typescript
// –û–±–Ω–æ–≤–ª—è–µ–º —Å–µ—Å—Å–∏—é –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
await update();

// –ò—Å–ø–æ–ª—å–∑—É–µ–º Next.js router –¥–ª—è SPA-–Ω–∞–≤–∏–≥–∞—Ü–∏–∏
router.push(redirectPath);
router.refresh();
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω useSession().update()
–≠—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–µ—Å—Å–∏—é –≤ React context –±–µ–∑ –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

### 3. –ù–∞—Å—Ç—Ä–æ–µ–Ω SessionProvider –≤ layout.tsx
```typescript
<SessionProvider 
  refetchInterval={5 * 60}        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
  refetchOnWindowFocus={true}     // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –Ω–∞ –æ–∫–Ω–µ
>
```

### 4. –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Header
```typescript
useEffect(() => {
  console.log("üîç Header session status:", status);
  console.log("üë§ Header session data:", session);
}, [session, status]);
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

‚úÖ **SPA-–Ω–∞–≤–∏–≥–∞—Ü–∏—è:** –ü–µ—Ä–µ—Ö–æ–¥ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ –±–µ–∑ –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏  
‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–µ—Å—Å–∏–∏:** `update()` –æ–±–Ω–æ–≤–ª—è–µ—Ç context –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ  
‚úÖ **–õ—É—á—à–∏–π UX:** –ë—ã—Å—Ç—Ä–µ–µ –∏ –ø–ª–∞–≤–Ω–µ–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** SessionProvider –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–µ—Å—Å–∏—é  

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ
```bash
npm run dev
```

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000
2. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ user@example.com / password
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏–º—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ Header
4. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–º—è ‚Üí –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è /profile –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ –≤—Ö–æ–¥–∞
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ª–æ–≥–æ–≤ —Å–µ—Å—Å–∏–∏

### –ù–∞ Vercel
1. –°–¥–µ–ª–∞–π—Ç–µ git push
2. –î–æ–∂–¥–∏—Ç–µ—Å—å –¥–µ–ø–ª–æ—è
3. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —à–∞–≥–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –û—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
- `üîç Header session status:` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `"authenticated"`
- `üë§ Header session data:` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `user` –æ–±—ä–µ–∫—Ç
- –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ /profile –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω–µ –ø–æ–º–æ–∂–µ—Ç)

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤—Å—ë –µ—â—ë –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è, –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ `window.location.href`, –Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

```typescript
// –§–æ—Ä—Å–∏—Ä—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
await fetch("/api/auth/session", { 
  method: "GET",
  headers: { "Cache-Control": "no-cache" }
});

// –ñ–¥—ë–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
await new Promise(resolve => setTimeout(resolve, 1500));

window.location.href = redirectPath;
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ cookies:** –í DevTools ‚Üí Application ‚Üí Cookies –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `next-auth.session-token`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ middleware:** –í `/src/middleware.ts` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:** –°–µ—Å—Å–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è database strategy)

---
**–î–∞—Ç–∞:** 2025-01-XX  
**–°—Ç–∞—Ç—É—Å:** –í —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏  
