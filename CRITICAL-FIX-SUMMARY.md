# üéâ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï - –í—Ö–æ–¥ –Ω–∞ Vercel

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### üî¥ –ü—Ä–æ–±–ª–µ–º–∞:
–í—Ö–æ–¥ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è –Ω–∞ Vercel –∏–∑-–∑–∞ **–∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ cookies —Å JWT**.

### üü¢ –†–µ—à–µ–Ω–∏–µ:
–£–¥–∞–ª—ë–Ω –±–ª–æ–∫ `cookies` –∏–∑ `src/auth.ts` - –ø—Ä–∏ `strategy: "jwt"` NextAuth v5 **—Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω–∞–º–∏**.

---

## üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ src/auth.ts

### ‚ùå –ë–´–õ–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
```typescript
export const { handlers, signIn, signOut, auth } = NextAuth({
  session: {
    strategy: "jwt",
  },
  cookies: {  // ‚ùå –ö–û–ù–§–õ–ò–ö–¢! –ü—Ä–∏ JWT —ç—Ç–æ–≥–æ –ù–ï –Ω—É–∂–Ω–æ
    sessionToken: {
      name: `next-auth.session-token`,
      options: {
        httpOnly: true,
        sameSite: 'lax',
        path: '/',
        secure: process.env.NODE_ENV === 'production',
      },
    },
  },
  trustHost: true,
  // ...
});
```

### ‚úÖ –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
```typescript
export const { handlers, signIn, signOut, auth } = NextAuth({
  session: {
    strategy: "jwt", // ‚úÖ NextAuth —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç JWT
    maxAge: 30 * 24 * 60 * 60, // 30 days
  },
  trustHost: true, // ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è Vercel
  // ‚úÖ –ë–ª–æ–∫ cookies —É–¥–∞–ª—ë–Ω
  // ...
});
```

---

## üîç –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ

| –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|---------|
| Cookie –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è | –ë–ª–æ–∫ `cookies` –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å `strategy: "jwt"` | –£–¥–∞–ª–∏—Ç—å –±–ª–æ–∫ `cookies` |
| –†–µ–¥–∏—Ä–µ–∫—Ç 307 –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞ | NextAuth –Ω–µ –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω | NextAuth —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç JWT |
| –°–µ—Å—Å–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è | –ö–∞—Å—Ç–æ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç JWT | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |

---

## üöÄ –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

1. ‚úÖ **–í—Ö–æ–¥ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è** - cookie –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
2. ‚úÖ **–†–µ–¥–∏—Ä–µ–∫—Ç 307 –∏—Å—á–µ–∑–Ω–µ—Ç** - NextAuth –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç JWT
3. ‚úÖ **/api/auth/session** –≤–µ—Ä–Ω—ë—Ç JSON —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
4. ‚úÖ **–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã** –≤—Ö–æ–¥ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º
5. ‚úÖ **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

---

## üì¶ –ö–æ–º–º–∏—Ç –∏ –¥–µ–ø–ª–æ–π

### –ö–æ–º–º–∏—Ç: `d5469dd`
```bash
fix: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è NextAuth –¥–ª—è JWT –Ω–∞ Vercel

üîß –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï auth.ts:
- ‚ùå –£–¥–∞–ª—ë–Ω –±–ª–æ–∫ 'cookies' - –ø—Ä–∏ strategy: jwt –Ω–µ –Ω—É–∂–µ–Ω
- ‚úÖ NextAuth v5 —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç JWT —Ç–æ–∫–µ–Ω–∞–º–∏
- ‚úÖ trustHost: true - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è Vercel
```

### –ó–∞–ø—É—à–µ–Ω–æ –Ω–∞ GitHub:
```
To https://github.com/Fodi999/menu-fodifood.git
   4cc2343..d5469dd  main -> main
```

### Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –û–±–Ω–∞—Ä—É–∂–∏—Ç –Ω–æ–≤—ã–π –∫–æ–º–º–∏—Ç
2. –ó–∞–ø—É—Å—Ç–∏—Ç –¥–µ–ø–ª–æ–π
3. –ü—Ä–∏–º–µ–Ω–∏—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
4. –í—Ö–æ–¥ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç! üéâ

---

## üß™ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å debug endpoint
```bash
curl https://menu-fodifood.vercel.app/api/debug-auth
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
```json
{
  "timestamp": "2025-10-05T15:00:00.000Z",
  "environment": "production",
  "session": null,
  "cookie": {
    "exists": false,
    "message": "Session cookie not found"
  },
  "env": {
    "NEXTAUTH_URL": "https://menu-fodifood.vercel.app",
    "NEXTAUTH_SECRET_EXISTS": true,
    "DATABASE_URL_EXISTS": true,
    "NODE_ENV": "production"
  }
}
```

### 2Ô∏è‚É£ –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É
```
URL: https://menu-fodifood.vercel.app/auth/signin

Email:    admin@fodisushi.com
Password: admin123
```

### 3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Å—Å–∏—é
```bash
curl https://menu-fodifood.vercel.app/api/auth/session
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è (–ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞):**
```json
{
  "user": {
    "email": "admin@fodisushi.com",
    "name": "Admin User",
    "role": "admin",
    "id": "..."
  },
  "expires": "2025-11-04T15:00:00.000Z"
}
```

### 4Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å cookies –≤ Chrome
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
2. Application ‚Üí Cookies ‚Üí menu-fodifood.vercel.app
3. –ù–∞–π–¥–∏—Ç–µ `next-auth.session-token`

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
- ‚úÖ Name: `next-auth.session-token`
- ‚úÖ HttpOnly: ‚úì
- ‚úÖ Secure: ‚úì
- ‚úÖ SameSite: `Lax`

### 5Ô∏è‚É£ –ó–∞–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É
```
URL: https://menu-fodifood.vercel.app/admin
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
- ‚úÖ –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à—ë–Ω –¥–ª—è admin@fodisushi.com
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- ‚úÖ –ù–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –Ω–∞ /auth/signin

---

## üìö –î–æ–±–∞–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `AUTH-CONFIG.md` | –ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è auth.ts |
| `FIX-COOKIES-JWT.md` | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã cookies+JWT |
| `VERCEL-ENV-CHECK.md` | –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è |
| `VERCEL-LOGIN-CHECK.md` | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–∞ –Ω–∞ Vercel |
| `VERCEL-LOGIN-TEST.md` | –ü–æ—à–∞–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ |
| `scripts/check-env.sh` | –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ env |

---

## ‚è±Ô∏è –°—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–µ–ø–ª–æ—è:
1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://vercel.com/dashboard
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç: **menu-fodifood**
3. –í–∫–ª–∞–¥–∫–∞: **Deployments**
4. –ò—â–∏—Ç–µ –∫–æ–º–º–∏—Ç: `d5469dd`

### –í—Ä–µ–º—è –¥–µ–ø–ª–æ—è:
- ‚è∞ –û–±—ã—á–Ω–æ: 1-3 –º–∏–Ω—É—Ç—ã
- üîÑ –°–µ–π—á–∞—Å: –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ...

### –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å (—á–µ—Ä–µ–∑ ~2 –º–∏–Ω—É—Ç—ã)
curl https://menu-fodifood.vercel.app/api/health

# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å
{"status":"ok"}
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–ø–ª–æ—è:

- [ ] `curl https://menu-fodifood.vercel.app/api/health` ‚Üí `{"status":"ok"}`
- [ ] –û—Ç–∫—Ä—ã—Ç—å https://menu-fodifood.vercel.app
- [ ] –ù–∞–∂–∞—Ç—å "Sign In"
- [ ] –í–≤–µ—Å—Ç–∏: admin@fodisushi.com / admin123
- [ ] –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ (—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é)
- [ ] –í DevTools ‚Üí Cookies –µ—Å—Ç—å `next-auth.session-token`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É (F5) - –≤—Ö–æ–¥ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è
- [ ] –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ /admin - –¥–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à—ë–Ω
- [ ] –í—ã–π—Ç–∏ (Sign Out) - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é
- [ ] –í–æ–π—Ç–∏ —Å–Ω–æ–≤–∞ - –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üéØ –ò—Ç–æ–≥

### –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞:
- ‚ùå –ë—ã–ª–æ: –≤—Ö–æ–¥ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è –Ω–∞ Vercel
- ‚úÖ –°—Ç–∞–ª–æ: –≤—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã:
–ö–æ–Ω—Ñ–ª–∏–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ `cookies` —Å `strategy: "jwt"`

### –†–µ—à–µ–Ω–∏–µ:
–£–¥–∞–ª—ë–Ω –±–ª–æ–∫ `cookies` - NextAuth v5 —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç JWT

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –í—Ö–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- ‚úÖ –ê–¥–º–∏–Ω–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
- ‚úÖ Cookie —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

---

**–°–æ–∑–¥–∞–Ω–æ:** 5 –æ–∫—Ç—è–±—Ä—è 2025 –≥., 17:30  
**–ö–æ–º–º–∏—Ç:** d5469dd  
**–°—Ç–∞—Ç—É—Å:** üöÄ –ó–∞–¥–µ–ø–ª–æ–µ–Ω–æ –Ω–∞ Vercel  
**–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:** ~2 –º–∏–Ω—É—Ç—ã
