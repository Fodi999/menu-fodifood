# ü§ñ Rust AI Chat Integration

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è AI —á–∞—Ç-–±–æ—Ç–∞ –Ω–∞ Rust —Å Next.js —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º —á–µ—Ä–µ–∑ WebSocket.

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îî‚îÄ‚îÄ chat/
‚îÇ       ‚îî‚îÄ‚îÄ page.tsx          # –°—Ç—Ä–∞–Ω–∏—Ü–∞ —á–∞—Ç–∞ —Å UI
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îî‚îÄ‚îÄ useChatSocket.ts      # WebSocket hook –¥–ª—è Rust –±–æ—Ç–∞
‚îî‚îÄ‚îÄ components/
    ‚îî‚îÄ‚îÄ Header.tsx            # –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "AI Chat"
```

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### `.env.local` (Development)
```bash
NEXT_PUBLIC_RUST_BOT_URL=http://127.0.0.1:8000
NEXT_PUBLIC_BACKEND_URL=http://127.0.0.1:8080
```

### `.env.production` (Production)
```bash
# Shuttle deployment
NEXT_PUBLIC_RUST_BOT_URL=https://fodifood-bot.shuttleapp.rs

# Koyeb deployment
NEXT_PUBLIC_RUST_BOT_URL=https://your-rust-bot.koyeb.app
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –•—É–∫ `useChatSocket`

```typescript
import { useChatSocket } from "@/hooks/useChatSocket";

const { messages, sendMessage, isConnected } = useChatSocket();
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `messages: string[]` - –ú–∞—Å—Å–∏–≤ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- `sendMessage: (text: string) => void` - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- `isConnected: boolean` - –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### 2. –°—Ç—Ä–∞–Ω–∏—Ü–∞ —á–∞—Ç–∞

**URL**: `/chat`
- –î–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "AI Chat" –≤ Header
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ê–≤—Ç–æ—Å–∫—Ä–æ–ª–ª –ø—Ä–∏ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

## üé® UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç shadcn/ui:
- `Card` - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–∞—Ç–∞
- `ScrollArea` - –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- `Input` - –ü–æ–ª–µ –≤–≤–æ–¥–∞
- `Button` - –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
- `Badge` - –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

## üîå WebSocket Protocol

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```
ws://127.0.0.1:8000/ws
```

### –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π

**–û—Ç –∫–ª–∏–µ–Ω—Ç–∞:**
```
"–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?"
```

**–û—Ç –±–æ—Ç–∞:**
```
"ü§ñ –û—Ç–≤–µ—Ç –æ—Ç AI..."
```

## üì± –î–æ—Å—Ç—É–ø –∫ —á–∞—Ç—É

### –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:
1. Header ‚Üí –∫–Ω–æ–ø–∫–∞ "AI Chat" (–∏–∫–æ–Ω–∫–∞ MessageCircle)
2. –ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞: http://localhost:3000/chat

### –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö:
- –í–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –∏–∫–æ–Ω–∫–∞ MessageCircle
- –ù–∞ –ø–ª–∞–Ω—à–µ—Ç–∞—Ö/–¥–µ—Å–∫—Ç–æ–ø–µ: –∏–∫–æ–Ω–∫–∞ + —Ç–µ–∫—Å—Ç "AI Chat"

## üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- SSR –ø—Ä–æ–≤–µ—Ä–∫–∞ (`typeof window === "undefined"`)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ WebSocket –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### UX
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –±–æ—Ç–∞
- ‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–∑–µ–ª–µ–Ω—ã–π/–∫—Ä–∞—Å–Ω—ã–π)
- ‚úÖ Disabled state –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω (mobile-first)

### –ò–∫–æ–Ω–∫–∏
- ü§ñ Bot - –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç AI
- üßë User - –°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ Wifi - –ü–æ–¥–∫–ª—é—á–µ–Ω–æ
- ‚ùå WifiOff - –û—Ç–∫–ª—é—á–µ–Ω–æ

## üõ†Ô∏è –ó–∞–ø—É—Å–∫

### Development
```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: Rust –±–æ—Ç
cd rust-bot
cargo run

# –¢–µ—Ä–º–∏–Ω–∞–ª 2: Next.js
npm run dev
```

### Production
1. –î–µ–ø–ª–æ–π Rust –±–æ—Ç–∞ –Ω–∞ Shuttle/Koyeb
2. –û–±–Ω–æ–≤–∏—Ç—å `NEXT_PUBLIC_RUST_BOT_URL` –≤ Vercel
3. –î–µ–ø–ª–æ–π Next.js –Ω–∞ Vercel

## üêõ Troubleshooting

### "Disconnected" –≤ —á–∞—Ç–µ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Rust –±–æ—Ç –∑–∞–ø—É—â–µ–Ω
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL: `http://127.0.0.1:8000/ws`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Rust –±–æ—Ç–µ

### WebSocket –æ—à–∏–±–∫–∏
```typescript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
WebSocket connection failed
```
**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –±–æ—Ç —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—Ç—É

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Frontend (Next.js)
    ‚Üì WebSocket
Rust Bot (Actix/Tokio)
    ‚Üì API
AI Service (OpenAI/Local)
```

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- Rust WebSocket server: `/rust-bot`
- Frontend chat: `/src/app/chat`
- Hook: `/src/hooks/useChatSocket.ts`

## üí° –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage)
- [ ] Typing indicator (–±–æ—Ç –ø–µ—á–∞—Ç–∞–µ—Ç...)
- [ ] Markdown —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- [ ] Voice-to-text
- [ ] –≠–º–æ–¥–∑–∏ picker
- [ ] –¢–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
