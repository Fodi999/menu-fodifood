# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ö–æ–¥–∞

## üîç –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ –ø—Ä–æ—Ñ–∏–ª—å, –∞ —Å–Ω–æ–≤–∞ –≤–∏–¥–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞.

## üõ†Ô∏è –ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–ò–∑–º–µ–Ω—ë–Ω –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ–¥–∏—Ä–µ–∫—Ç—É –ø–æ—Å–ª–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ö–æ–¥–∞:

```typescript
// ‚ùå –°–¢–ê–†–´–ô –°–ü–û–°–û–ë (–Ω–µ —Ä–∞–±–æ—Ç–∞–ª —Å—Ç–∞–±–∏–ª—å–Ω–æ)
const result = await signIn(..., { redirect: false });
router.push("/profile"); // SPA –ø–µ—Ä–µ—Ö–æ–¥ - —Å–µ—Å—Å–∏—è –º–æ–≥–ª–∞ –Ω–µ —É—Å–ø–µ—Ç—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è

// ‚úÖ –ù–û–í–´–ô –°–ü–û–°–û–ë
const result = await signIn(..., { redirect: false });
if (result?.ok) {
  window.location.href = "/profile"; // –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–µ–π
}
```

## üìù –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev-—Å–µ—Ä–≤–µ—Ä
```bash
npm run dev
```

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
–°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

### 3. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
```
http://localhost:3000/auth/signup
```

### 4. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —Å –Ω–æ–≤—ã–º email
```
–ò–º—è: Test User
Email: test999@test.com  (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π!)
–ü–∞—Ä–æ–ª—å: test123
–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ: test123
```

### 5. –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

#### –í –∫–æ–Ω—Å–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –ª–æ–≥–∏:
```
‚úÖ Registration successful, logging in...
üîê Attempting credentials authorization...
‚úÖ Successful login: test999@test.com (user)
üîë JWT created for: test999@test.com (role: user)
‚úÖ Auto-login successful, redirecting to profile...
```

#### –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:
1. –ü–æ—è–≤–∏—Ç—Å—è –∑–µ–ª—ë–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: **"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ö–æ–¥..."**
2. –ü—Ä–æ–∏–∑–æ–π–¥—ë—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ `/profile`
3. –í—ã —É–≤–∏–¥–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–æ—Ñ–∏–ª—è —Å –≤–∞—à–∏–º –∏–º–µ–Ω–µ–º

### 6. –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

#### A. Cookies –≤ –±—Ä–∞—É–∑–µ—Ä–µ
```
F12 ‚Üí Application ‚Üí Cookies ‚Üí http://localhost:3000
```

–î–æ–ª–∂–µ–Ω –±—ã—Ç—å cookie: `next-auth.session-token` –∏–ª–∏ `__Secure-next-auth.session-token`

#### B. –°–µ—Å—Å–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏
–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/profile` –æ—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```javascript
fetch('/api/auth/session')
  .then(r => r.json())
  .then(console.log);
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è –æ–±—ä–µ–∫—Ç —Å `user`:
```json
{
  "user": {
    "email": "test999@test.com",
    "name": "Test User",
    "role": "user",
    "id": "..."
  },
  "expires": "..."
}
```

#### C. Database
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–ª—Å—è:
```bash
npx prisma studio
```

–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É `User` –∏ –Ω–∞–π–¥–∏—Ç–µ `test999@test.com`

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞, –Ω–æ –Ω–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ö–æ–¥"
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –ø—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º –≤—Ö–æ–¥–µ (–º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ)

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ `/auth/signin`

### 2. –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/auth/signin` –≤–º–µ—Å—Ç–æ `/profile`
**–ü—Ä–∏—á–∏–Ω–∞:** –°–µ—Å—Å–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞—Å—å

**–†–µ—à–µ–Ω–∏–µ:** 
- –û—á–∏—Å—Ç–∏—Ç–µ cookies: `F12` ‚Üí Application ‚Üí Clear storage
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev-—Å–µ—Ä–≤–µ—Ä
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ

### 3. "User already exists"
**–ü—Ä–∏—á–∏–Ω–∞:** Email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π email –∏–ª–∏ —É–¥–∞–ª–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ Prisma Studio

## üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Vercel

### 1. –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –æ—Ç–∫—Ä–æ–π—Ç–µ
```
https://–≤–∞—à-–¥–æ–º–µ–Ω.vercel.app/auth/signup
```

### 2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —Å –Ω–æ–≤—ã–º email

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Vercel
```
Vercel Dashboard ‚Üí Project ‚Üí Deployments ‚Üí Logs
```

–ò—â–∏—Ç–µ –ª–æ–≥–∏ –≤–∏–¥–∞:
```
‚úÖ Successful login: email@test.com (user)
üîë JWT created for: email@test.com (role: user)
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö Neon
```bash
npx prisma studio --schema=./prisma/schema.prisma
```

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

| –ú–µ—Ç–æ–¥ | –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ | –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ |
|-------|--------------|------------|
| `router.push()` | ‚úÖ –ú—è–≥–∫–∞—è SPA-–Ω–∞–≤–∏–≥–∞—Ü–∏—è<br>‚úÖ –ù–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ | ‚ùå –°–µ—Å—Å–∏—è –º–æ–∂–µ—Ç –Ω–µ —É—Å–ø–µ—Ç—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è<br>‚ùå –¢—Ä–µ–±—É–µ—Ç `router.refresh()` |
| `window.location.href` | ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞<br>‚úÖ –°–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∏—Ç —Å–≤–µ–∂–∏–µ cookies | ‚ùå –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã<br>‚ùå "–ú–æ—Ä–≥–∞–Ω–∏–µ" –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ |
| `signIn(..., {redirect: true})` | ‚úÖ NextAuth —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç<br>‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç redirect callback | ‚ùå –ú–µ–Ω—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—è<br>‚ùå –ú–æ–∂–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç—å –Ω–µ —Ç—É–¥–∞ |

**–í—ã–±—Ä–∞–Ω:** `window.location.href` - –∫–∞–∫ —Å–∞–º—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ö–æ–¥–∞ –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.

## ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

```typescript
// signup/page.tsx
const result = await signIn("credentials", {
  email: formData.email,
  password: formData.password,
  redirect: false, // –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ç—Ä–æ–ª—å
});

if (result?.ok) {
  // –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Å–µ—Å—Å–∏–∏
  window.location.href = "/profile";
} else {
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
  setError("...");
}
```

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
